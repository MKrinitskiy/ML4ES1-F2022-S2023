## Домашнее задание по теме "Мультиномиальная логистическая регрессия и оценка качества моделей классификации".

Номинальный балл = 100.

Вес = 1.0

Срок сдачи - **13.04.2022**



Стартом для выполнения этого ДЗ может стать ноутбук с кодом, который можно скачать [здесь](https://github.com/MKrinitskiy/ML4ES1-F2022-S2023/blob/master/HW06/HW05.ipynb)

Обратите внимание, что в этом ноутбуке одной из первых исполняемых ячеек закачиваются данные для исследования - набор данных рукописных цифр MNIST. Для тех, кто рассчитывает выполнять задание полностью самостоятельно, приводятся ссылки на файлы [данных (признаковое описание объектов)](https://ml4es.ru/links/mnist-data) и [меток (категориальная целевая переменная - арабские цифры)](https://ml4es.ru/links/mnist-labels).

Основной технической задачей настоящего ДЗ является применение модели мультиномиальной логистической регрессии на данных набора рукописных цифр MNIST. Однако действительно главной задачей должна стать оценка качества и неопределенности каждой из мер качества примененной модели на данных MNIST.

В решении ожидается следующее:

- (10 баллов) Формулировка задачи: тип, вид, формулировка мер качества, формулировка меры неопределенности для мер качества модели и для вероятностей классов объектов;

- (5 баллов) Считывание данных и отображение нескольких примеров из набора данных с отображением соответствующих меток;

- (5 баллов) Демонстрация распределения данных;

- (10 баллов) Обучение и применение модели мультномиальной логистической регрессии*

- (10 баллов) Оценка качества этой ОДНОЙ модели (Accuracy, TPR, FPR, Precision, Recall, F1-score)
  
  `Подсказка: здесь следует помнить о том, насколько корректно оценивать качество модели на тренировочной выборке (некорректно, оценка качества будет недостоверной); на какой выборке следует оценивать качество обученной модели. Полный балл будет выставлен только при корректной оценке мер качества.`
  
- В соответствии с методологией, включающей **bootstrap**-сэмплирование, оценить неопределенность мер качества модели. Здесь, ожидается, что будут проведены следующие исследования:
  - (10 баллов) подбор **оптимального количества** bootstrap-выборок для оценки неопределенности качества модели. Повышайте количество bootstrap-выборок до тех пор, пока неопределенность мер качества не придет в насыщение;
  - (10 баллов) подбор **оптимального размера** bootstrap-выборок для оценки неопределенности качества модели. Повышайте размер bootstrap-выборок до тех пор, пока неопределенность мер качества не придет в насыщение;
  - (10 баллов) **оценка среднего** значения **и неопределенностей** мер качества с использованием подобранных количества и размера bootstrap-выборок;

- (10 баллов) Применение обученных моделей и оценка неопределенности вероятностей каждого класса для каждого примера из тестовой выборки.

  `Самопроверка: если объектов в тестовой выборке - N штук, то матрица вероятностей, оцененных ОДНОЙ моделью в задаче на K классов должна быть размером NxK; тензор вероятностей, оцененных B моделями должен быть размерности NxKxB; осредненные оценки вероятностей и их неопределенности должны быть размерности NxK;`

- (10 баллов) Найти 10 примеров, для которых эта неопределенность для превалирующего для них класса максимальна;

  `Подсказка: для того, чтобы найти превалирующий класс для каждого объекта, следует найти класс, для которого средняя по B моделям оценка вероятности максимальна из всех K классов; он будет свой для каждого объекта тестовой выборки; неопределенность превалирующего класса следует получить для каждого объекта тестовой выборки именно для этого класса - определенного как превалирующий по средней вероятности из всех B моделей.`

- (10 баллов) Отобразить эти 10 примеров их и прокомментировать, почему, на ваш  взгляд, модель может быть неуверенна в оценке вероятностей для этих  примеров.

`Техническое замечание: следует учесть, что набор данных MNIST намного больше, чем те, с которыми мы работали прежде, поэтому обучение одной модели из B штук займет больше времени. Поэтому следует особенно внимательно отнестись к этапу подбора оптимального количества bootstrap-выборок (следовательно, и количества обученных на них моделей). `

*можно использовать реализацию из пакета `scikit-learn`

